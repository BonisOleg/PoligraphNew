{% load static %}
<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}PolygraphNew{% endblock %}</title>
    
    <!-- ============================================================================ -->
    <!-- ⚠️ КРИТИЧНО: Порядок підключення НЕ ЗМІНЮВАТИ!                            -->
    <!-- Цей порядок забезпечує оптимальну продуктивність та відсутність конфліктів -->
    <!-- ============================================================================ -->
    
    <!-- PRECONNECT для оптимізації завантаження з CDN -->
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
    
    <!-- PRECONNECT для Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- 1. CSS ФАЙЛИ (ЗАВЖДИ ПЕРШІ, БЛОКУЮЧІ) -->
    <!-- 1.1 normalize.css - НЕДОТОРКАННИЙ, ЗАВЖДИ ПЕРШИЙ -->
    <link rel="stylesheet" href="{% static 'css/normalize.css' %}">
    
    <!-- 1.2 base.css - базові стилі проекту -->
    <link rel="stylesheet" href="{% static 'css/base.css' %}">
    
    <!-- 1.3 components/*.css - компоненти -->
    <!-- ВСІ CSS завантажуються одразу для роботи HTMX навігації -->
    <link rel="stylesheet" href="{% static 'css/components/header.css' %}">
    <link rel="stylesheet" href="{% static 'css/components/footer.css' %}">
    <link rel="stylesheet" href="{% static 'css/components/hero.css' %}">
    <link rel="stylesheet" href="{% static 'css/components/why-us.css' %}">
    <link rel="stylesheet" href="{% static 'css/components/cta.css' %}">
    <link rel="stylesheet" href="{% static 'css/components/accordion.css' %}">
    <link rel="stylesheet" href="{% static 'css/components/contacts.css' %}">
    <link rel="stylesheet" href="{% static 'css/components/page.css' %}">
    
    <!-- 1.4 utilities/*.css - утиліти (додавайте свої утиліти тут) -->
    {% block utility_css %}{% endblock %}
    
    <!-- 1.5 page-specific.css - стилі конкретних сторінок -->
    {% block page_css %}{% endblock %}
    
    <!-- 1.6 Google Fonts - преміум шрифти з підтримкою кирилиці -->
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@600;700&family=Montserrat:wght@500;600;700&family=Inter:wght@400;500&display=swap&subset=cyrillic" rel="stylesheet">
    
    <!-- 2. CSRF TOKEN (для HTMX форм) -->
    <meta name="csrf-token" content="{{ csrf_token }}">
    
    <!-- 3. HTMX (З DEFER, НЕБЛОКУЮЧЕ ЗАВАНТАЖЕННЯ) -->
    <script src="https://cdn.jsdelivr.net/npm/htmx.org@2.0.8/dist/htmx.min.js" 
            integrity="sha384-/TgkGk7p307TH7EXJDuUlgG3Ce1UVolAOFopFekQkkXihi5u/6OCvVKyz1W+idaz" 
            crossorigin="anonymous" 
            defer></script>
    
    {% block extra_head %}{% endblock %}
</head>
<body{% if request.resolver_match.url_name == 'about' %} class="body--about"{% endif %}>
    <header class="header" role="banner">
        <!-- КАПСУЛА: один контейнер що розтягується -->
        <div class="header__capsule" data-open="false">
            <!-- Кнопка: MENU/X toggle -->
            <button class="header__toggle" 
                    type="button" 
                    aria-expanded="false" 
                    aria-label="Відкрити меню">
                <span class="header__label" aria-hidden="true">MENU</span>
                <span class="header__close" aria-hidden="true">✕</span>
            </button>
            
            <!-- Навігація: 3 посилання (розтягуються з капсулою) -->
            <nav class="header__nav" 
                 id="main-navigation" 
                 aria-label="Головна навігація"
                 hidden>
                <ul class="header__nav-list" role="list">
                    <li class="header__nav-item">
                        <a href="{% url 'pages:index' %}" 
                           class="header__nav-link"
                           {% if request.resolver_match.url_name == 'index' %}aria-current="page"{% endif %}
                           hx-get="{% url 'pages:index' %}"
                           hx-target="#main"
                           hx-swap="innerHTML"
                           hx-push-url="true">
                            Головна
                        </a>
                    </li>
                    <li class="header__nav-item">
                        <a href="{% url 'pages:about' %}" 
                           class="header__nav-link"
                           {% if request.resolver_match.url_name == 'about' %}aria-current="page"{% endif %}
                           hx-get="{% url 'pages:about' %}"
                           hx-target="#main"
                           hx-swap="innerHTML"
                           hx-push-url="true">
                            Послуги
                        </a>
                    </li>
                    <li class="header__nav-item">
                        <a href="{% url 'pages:contacts' %}" 
                           class="header__nav-link"
                           {% if request.resolver_match.url_name == 'contacts' %}aria-current="page"{% endif %}
                           hx-get="{% url 'pages:contacts' %}"
                           hx-target="#main"
                           hx-swap="innerHTML"
                           hx-push-url="true">
                            Контакти
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    {% block content %}{% endblock %}
    
    <footer class="footer">
        {% include 'partials/footer_content.html' %}
    </footer>
    
    <!-- 4. ВЛАСНІ JS ФАЙЛИ (ПІСЛЯ HTMX, З DEFER) -->
    <!-- Порядок КРИТИЧНО ВАЖЛИВИЙ: модулі → app-init → hero → main-sync -->
    <script src="{% static 'js/header.js' %}" defer></script>
    <script src="{% static 'js/accordion.js' %}" defer></script>
    <script src="{% static 'js/why-us.js' %}" defer></script>
    <script src="{% static 'js/footer-accordion.js' %}" defer></script>
    <script src="{% static 'js/app-init.js' %}" defer></script>
    <script src="{% static 'js/hero.js' %}" defer></script>
    <script src="{% static 'js/main-class-sync.js' %}" defer></script>
</body>
</html>

